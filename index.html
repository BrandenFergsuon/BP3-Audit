<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BP3 Cookie Audit</title>
    <style>
        :root {
            --primary-blue: #1a73e8;
            --primary-red: #d23f31;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --highlight-color: rgba(26, 115, 232, 0.2);
            
            /* Gradient variables */
            --color-bg1: rgb(108, 0, 162);
            --color-bg2: rgb(0, 17, 82);
            --color1: 18, 113, 255;
            --color2: 221, 74, 255;
            --color3: 100, 220, 255;
            --color4: 200, 50, 50;
            --color5: 180, 180, 50;
            --color-interactive: 140, 100, 255;
            --circle-size: 80%;
            --blending: hard-light;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            min-height: 100vh;
            padding: 40px;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }

        .gradient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            overflow: hidden;
            background: linear-gradient(40deg, var(--color-bg1), var(--color-bg2));
            opacity: 0.9;
        }

        .gradient-bg svg {
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
        }

        .gradients-container {
            filter: url(#goo) blur(40px);
            width: 100%;
            height: 100%;
        }

        .g1 {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color1), 0.8) 0, rgba(var(--color1), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: var(--circle-size);
            height: var(--circle-size);
            top: calc(50% - var(--circle-size) / 2);
            left: calc(50% - var(--circle-size) / 2);
            transform-origin: center center;
            animation: moveVertical 30s ease infinite;
            opacity: 1;
        }

        .g2 {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color2), 0.8) 0, rgba(var(--color2), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: var(--circle-size);
            height: var(--circle-size);
            top: calc(50% - var(--circle-size) / 2);
            left: calc(50% - var(--circle-size) / 2);
            transform-origin: calc(50% - 400px);
            animation: moveInCircle 20s reverse infinite;
            opacity: 1;
        }

        .g3 {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color3), 0.8) 0, rgba(var(--color3), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: var(--circle-size);
            height: var(--circle-size);
            top: calc(50% - var(--circle-size) / 2 + 200px);
            left: calc(50% - var(--circle-size) / 2 - 500px);
            transform-origin: calc(50% + 400px);
            animation: moveInCircle 40s linear infinite;
            opacity: 1;
        }

        .g4 {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color4), 0.8) 0, rgba(var(--color4), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: var(--circle-size);
            height: var(--circle-size);
            top: calc(50% - var(--circle-size) / 2);
            left: calc(50% - var(--circle-size) / 2);
            transform-origin: calc(50% - 200px);
            animation: moveHorizontal 40s ease infinite;
            opacity: 0.7;
        }

        .g5 {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color5), 0.8) 0, rgba(var(--color5), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: calc(var(--circle-size) * 2);
            height: calc(var(--circle-size) * 2);
            top: calc(50% - var(--circle-size));
            left: calc(50% - var(--circle-size));
            transform-origin: calc(50% - 800px) calc(50% + 200px);
            animation: moveInCircle 20s ease infinite;
            opacity: 1;
        }

        .interactive {
            position: absolute;
            background: radial-gradient(circle at center, rgba(var(--color-interactive), 0.8) 0, rgba(var(--color-interactive), 0) 50%) no-repeat;
            mix-blend-mode: var(--blending);
            width: 100%;
            height: 100%;
            top: -50%;
            left: -50%;
            opacity: 0.7;
        }

        @keyframes moveInCircle {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes moveVertical {
            0% { transform: translateY(-50%); }
            50% { transform: translateY(50%); }
            100% { transform: translateY(-50%); }
        }

        @keyframes moveHorizontal {
            0% { transform: translateX(-50%) translateY(-10%); }
            50% { transform: translateX(50%) translateY(10%); }
            100% { transform: translateX(-50%) translateY(-10%); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        h1 {
            color: white;
            font-size: 2.5rem;
            font-weight: 300;
            padding: 5px;
            border-radius: 4px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }

        .date {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            padding: 5px;
            border-radius: 4px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .cookie-section {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-blue);
            font-weight: 500;
        }

        .paste-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .paste-box {
            flex: 1;
            min-height: 200px;
            border-radius: 8px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--card-shadow);
        }

        .paste-box h3 {
            margin-bottom: 10px;
            color: var(--primary-blue);
        }

        .paste-textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            resize: vertical;
            background: rgba(255, 255, 255, 0.8);
            font-family: monospace;
        }

        .compare-btn {
            display: block;
            margin: 20px auto;
            padding: 12px 24px;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .compare-btn:hover {
            background: #0d5bc2;
        }

        .results-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .results-box {
            flex: 1;
            min-height: 150px;
            border-radius: 8px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--card-shadow);
        }

        .results-box h3 {
            margin-bottom: 15px;
            color: var(--primary-blue);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding-bottom: 10px;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-family: monospace;
            font-size: 0.9rem;
        }

        .dropped-item {
            background: rgba(230, 247, 255, 0.9);
        }

        .added-item {
            background: rgba(246, 255, 237, 0.9);
        }

        /* Cookie Details Table Styles */
        .cookie-details-container {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .cookie-details-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .cookie-details-table th {
            background: rgba(26, 115, 232, 0.1);
            padding: 10px;
            text-align: left;
            border-bottom: 2px solid rgba(26, 115, 232, 0.3);
        }

        .cookie-details-table td {
            padding: 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            vertical-align: top;
        }

        .cookie-details-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.3);
        }

        .cookie-details-table tr:hover {
            background: rgba(26, 115, 232, 0.05);
        }

        .cookie-details-scroll {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
            border-radius: 6px;
        }

        .cookie-details-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .cookie-details-scroll::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }

        .cookie-details-scroll::-webkit-scrollbar-thumb {
            background: rgba(26, 115, 232, 0.3);
            border-radius: 4px;
        }

        .cookie-details-scroll::-webkit-scrollbar-thumb:hover {
            background: rgba(26, 115, 232, 0.5);
        }

        .placeholder-row {
            height: 36px;
        }

        .placeholder-row td {
            color: rgba(0, 0, 0, 0.2);
            font-style: italic;
        }

        .action-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 30px;
            gap: 15px;
        }

        .save-btn, .load-btn, .export-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .save-btn {
            background: var(--primary-blue);
            color: white;
        }

        .save-btn:hover {
            background: #0d5bc2;
        }

        .load-btn {
            background: white;
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }

        .load-btn:hover {
            background: rgba(26, 115, 232, 0.1);
        }

        .export-btn {
            background: #34a853;
            color: white;
        }

        .export-btn:hover {
            background: #2d9248;
        }

        /* Calendar Styles */
        .calendar {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
            box-shadow: var(--card-shadow);
        }

        .calendar th {
            padding: 10px;
            text-align: center;
            background: rgba(245, 245, 245, 0.6);
            font-weight: 500;
        }

        .calendar td {
            padding: 10px;
            text-align: left;
            border: 1px solid rgba(238, 238, 238, 0.8);
            cursor: pointer;
            position: relative;
            height: 80px;
            width: 14.28%;
            vertical-align: top;
            background: rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
        }

        .calendar-day {
            font-weight: bold;
            font-size: 1rem;
            position: absolute;
            top: 5px;
            left: 5px;
            z-index: 2;
        }

        .calendar-day.today {
            color: var(--primary-blue);
        }

        .calendar-note {
            position: absolute;
            top: 30px;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 5px;
            font-size: 0.8rem;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .calendar-note-preview {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 300px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        .calendar td:hover .calendar-note-preview {
            display: block;
        }

        .calendar td.selected {
            background-color: var(--highlight-color);
        }

        .calendar td.empty {
            background: rgba(249, 249, 249, 0.6);
            cursor: default;
        }

        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-title {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .calendar-nav button {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .calendar-nav button:hover {
            background: #0d5bc2;
        }

        @media (max-width: 768px) {
            body {
                padding: 20px;
            }
            
            .paste-container {
                flex-direction: column;
            }
            
            .results-container {
                flex-direction: column;
            }
            
            .calendar td {
                height: 60px;
                font-size: 0.9rem;
            }
            
            .calendar-day {
                font-size: 0.9rem;
            }
            
            .calendar-note {
                display: none;
            }
            
            .calendar-note-preview {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="gradient-bg">
        <svg xmlns="http://www.w3.org/2000/svg">
            <defs>
                <filter id="goo">
                    <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
                    <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8" result="goo" />
                    <feBlend in="SourceGraphic" in2="goo" />
                </filter>
            </defs>
        </svg>
        <div class="gradients-container">
            <div class="g1"></div>
            <div class="g2"></div>
            <div class="g3"></div>
            <div class="g4"></div>
            <div class="g5"></div>
            <div class="interactive"></div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>BP3 Cookie Audit</h1>
            <div class="date" id="current-date">Loading date...</div>
        </header>

        <div class="cookie-section">
            <h2 class="section-title">Cookie Comparison</h2>
            
            <div class="paste-container">
                <div class="paste-box">
                    <h3>Before Accepting Cookies</h3>
                    <textarea class="paste-textarea" id="before-cookies" placeholder="Paste cookie list here (one per line)..."></textarea>
                </div>
                
                <div class="paste-box">
                    <h3>After Accepting Cookies</h3>
                    <textarea class="paste-textarea" id="after-cookies" placeholder="Paste cookie list here (one per line)..."></textarea>
                </div>
            </div>
            
            <button class="compare-btn" id="compare-btn">Compare Cookies</button>
            
            <div class="results-container">
                <div class="results-box">
                    <h3>Dropped Cookies</h3>
                    <div id="dropped-list"></div>
                </div>
                
                <div class="results-box">
                    <h3>Added Cookies</h3>
                    <div id="added-list"></div>
                </div>
            </div>

            <!-- Cookie Details Table -->
            <div class="cookie-details-container">
                <h3>Cookie Details</h3>
                <div class="cookie-details-scroll">
                    <table class="cookie-details-table" id="cookie-details-table">
                        <thead>
                            <tr>
                                <th>Cookie Name</th>
                                <th>Domain</th>
                                <th>Purpose</th>
                                <th>Required</th>
                                <th>Reason</th>
                            </tr>
                        </thead>
                        <tbody id="cookie-details-body">
                            <!-- Placeholder rows will be replaced by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="cookie-section">
            <h2 class="section-title">Audit Calendar</h2>
            <div id="calendar-container"></div>
        </div>

        <div class="action-buttons">
            <button class="load-btn" id="load-btn">Load Audit</button>
            <button class="save-btn" id="save-btn">Save Audit</button>
            <button class="export-btn" id="export-btn">Export to PowerPoint</button>
        </div>
    </div>

    <input type="file" id="load-upload" class="file-input" accept=".json">

    <script>
        // Cookie database with all the details
        const cookieDatabase = [
            { name: "__cf_bm", domain: ".linkedin.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hs-banner.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hsforms.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hubspot.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hsadspixel.net", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hs-scripts.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hs-analytics.net", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".www.bp-3.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".usemessages.com", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__cf_bm", domain: ".hsforms.net", purpose: "Bot management and security (Cloudflare)", required: "Yes", reason: "Essential for preventing bot attacks and ensuring security." },
            { name: "__hs_cookie_cat_pref", domain: ".hubspot.com", purpose: "Stores user cookie preferences for HubSpot", required: "No", reason: "Non-essential; only used for preference tracking." },
            { name: "__hs_do_not_track", domain: ".bp-3.com", purpose: "Indicates if the user has opted out of tracking (HubSpot)", required: "No", reason: "Optional; only relevant if user opts out of tracking." },
            { name: "__hssc", domain: ".bp-3.com", purpose: "HubSpot session cookie for website analytics", required: "Yes", reason: "Necessary for session tracking and basic website functionality." },
            { name: "__hssrc", domain: ".bp-3.com", purpose: "HubSpot session restart cookie (resets session)", required: "Yes", reason: "Necessary for session management." },
            { name: "__hstc", domain: ".hubspot.com", purpose: "HubSpot analytics tracking cookie", required: "No", reason: "Used for marketing analytics; not essential for core functionality." },
            { name: "__hstc", domain: ".bp-3.com", purpose: "HubSpot analytics tracking cookie", required: "No", reason: "Used for marketing analytics; not essential for core functionality." },
            { name: "__Secure-1PAPISID", domain: ".google.com", purpose: "Google authentication and security (first-party)", required: "Yes", reason: "Critical for user authentication and security." },
            { name: "__Secure-1PAPISID", domain: ".google.co.za", purpose: "Google authentication and security (first-party)", required: "Yes", reason: "Critical for user authentication and security." },
            { name: "__Secure-1PSID", domain: ".google.com", purpose: "Google session authentication (first-party)", required: "Yes", reason: "Critical for maintaining user sessions." },
            { name: "__Secure-1PSID", domain: ".google.co.za", purpose: "Google session authentication (first-party)", required: "Yes", reason: "Critical for maintaining user sessions." },
            { name: "__Secure-1PSIDCC", domain: ".google.com", purpose: "Google session authentication with cross-domain context (first-party)", required: "Yes", reason: "Critical for cross-domain authentication." },
            { name: "__Secure-1PSIDTS", domain: ".google.com", purpose: "Google session authentication timestamp (first-party)", required: "Yes", reason: "Critical for session security." },
            { name: "__Secure-3PAPISID", domain: ".google.co.za", purpose: "Google authentication and security (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "__Secure-3PAPISID", domain: ".google.com", purpose: "Google authentication and security (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "__Secure-3PSID", domain: ".google.co.za", purpose: "Google session authentication (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "__Secure-3PSID", domain: ".google.com", purpose: "Google session authentication (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "__Secure-3PSIDCC", domain: ".google.com", purpose: "Google session authentication with cross-domain context (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "__Secure-3PSIDTS", domain: ".google.com", purpose: "Google session authentication timestamp (third-party)", required: "No", reason: "Used for cross-site tracking; not essential for core functionality." },
            { name: "_cfuvid", domain: ".hsforms.com", purpose: "Cloudflare unique visitor ID for security", required: "Yes", reason: "Essential for identifying legitimate traffic and preventing abuse." },
            { name: "_cfuvid", domain: ".hubspot.com", purpose: "Cloudflare unique visitor ID for security", required: "Yes", reason: "Essential for identifying legitimate traffic and preventing abuse." },
            { name: "_cfuvid", domain: ".www.bp-3.com", purpose: "Cloudflare unique visitor ID for security", required: "Yes", reason: "Essential for identifying legitimate traffic and preventing abuse." },
            { name: "_ga", domain: ".hubspot.com", purpose: "Google Analytics tracking", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "_ga", domain: ".bp-3.com", purpose: "Google Analytics tracking", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "_ga_9509KVHXFM", domain: ".bp-3.com", purpose: "Google Analytics tracking (specific property)", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "_ga_LXTM6CQ0XK", domain: ".hubspot.com", purpose: "Google Analytics tracking (specific property)", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "_gcl_au", domain: ".bp-3.com", purpose: "Google Ads conversion tracking", required: "No", reason: "Used for ad tracking; not essential for core functionality." },
            { name: "_guid", domain: ".linkedin.com", purpose: "LinkedIn user tracking and identification", required: "No", reason: "Used for tracking; not essential for core functionality." },
            { name: "_hjSession_5317919", domain: ".bp-3.com", purpose: "Hotjar session tracking for user behavior analytics", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "_hjSessionUser_5317919", domain: ".bp-3.com", purpose: "Hotjar user identification across sessions", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "AEC", domain: ".google.com", purpose: "Google Ads click validation", required: "Yes", reason: "Essential for fraud prevention in ad clicks." },
            { name: "AnalyticsSyncHistory", domain: ".linkedin.com", purpose: "LinkedIn ad analytics and sync history", required: "No", reason: "Used for ad tracking; not essential for core functionality." },
            { name: "APISID", domain: ".google.co.za", purpose: "Google authentication and preferences", required: "Yes", reason: "Essential for user authentication and security." },
            { name: "APISID", domain: ".google.com", purpose: "Google authentication and preferences", required: "Yes", reason: "Essential for user authentication and security." },
            { name: "ar_debug", domain: ".googleadservices.com", purpose: "Google Ads debugging", required: "No", reason: "Used for debugging; not essential for core functionality." },
            { name: "ar_debug", domain: "px.ads.linkedin.com", purpose: "LinkedIn Ads debugging", required: "No", reason: "Used for debugging; not essential for core functionality." },
            { name: "ar_debug", domain: ".doubleclick.net", purpose: "DoubleClick (Google Ads) debugging", required: "No", reason: "Used for debugging; not essential for core functionality." },
            { name: "bcookie", domain: ".linkedin.com", purpose: "LinkedIn browser identification cookie", required: "Yes", reason: "Essential for fraud prevention and security." },
            { name: "dfpfpt", domain: ".linkedin.com", purpose: "LinkedIn fraud prevention", required: "Yes", reason: "Essential for fraud prevention and security." },
            { name: "DV", domain: "www.google.com", purpose: "Google authentication security", required: "Yes", reason: "Essential for authentication security." },
            { name: "fptctx2", domain: ".linkedin.com", purpose: "LinkedIn fraud prevention and security", required: "Yes", reason: "Essential for fraud prevention and security." },
            { name: "HSID", domain: ".google.co.za", purpose: "Google security and authentication", required: "Yes", reason: "Essential for authentication and security." },
            { name: "HSID", domain: ".google.com", purpose: "Google security and authentication", required: "Yes", reason: "Essential for authentication and security." },
            { name: "hubspotutk", domain: ".hubspot.com", purpose: "HubSpot tracking for form submissions and analytics", required: "No", reason: "Used for marketing tracking; not essential for core functionality." },
            { name: "hubspotutk", domain: ".bp-3.com", purpose: "HubSpot tracking for form submissions and analytics", required: "No", reason: "Used for marketing tracking; not essential for core functionality." },
            { name: "IDE", domain: ".doubleclick.net", purpose: "Google Ads targeting and retargeting", required: "No", reason: "Used for ad targeting; not essential for core functionality." },
            { name: "laboratory-anonymous-id", domain: ".hubspot.com", purpose: "HubSpot testing and experimentation", required: "No", reason: "Used for testing; not essential for core functionality." },
            { name: "lang", domain: ".linkedin.com", purpose: "LinkedIn language preference", required: "No", reason: "Used for preference storage; not essential for core functionality." },
            { name: "li_gc", domain: ".linkedin.com", purpose: "LinkedIn guest consent for cookies", required: "No", reason: "Used for consent tracking; not essential for core functionality." },
            { name: "li_sugr", domain: ".linkedin.com", purpose: "LinkedIn user matching and personalization", required: "No", reason: "Used for personalization; not essential for core functionality." },
            { name: "liap", domain: ".linkedin.com", purpose: "LinkedIn API authentication", required: "Yes", reason: "Essential for API authentication and security." },
            { name: "lidc", domain: ".linkedin.com", purpose: "LinkedIn routing and performance optimization", required: "Yes", reason: "Essential for load balancing and performance." },
            { name: "lms_ads", domain: ".linkedin.com", purpose: "LinkedIn ad tracking", required: "No", reason: "Used for ad tracking; not essential for core functionality." },
            { name: "lms_analytics", domain: ".linkedin.com", purpose: "LinkedIn analytics tracking", required: "No", reason: "Used for analytics; not essential for core functionality." },
            { name: "NID", domain: ".google.com", purpose: "Google preferences and security (e.g., language settings)", required: "Yes", reason: "Essential for user preferences and security." },
            { name: "NID", domain: ".google.co.za", purpose: "Google preferences and security (e.g., language settings)", required: "Yes", reason: "Essential for user preferences and security." },
            { name: "OptanonConsent", domain: ".bp-3.com", purpose: "OneTrust cookie consent preferences", required: "Yes", reason: "Essential for GDPR compliance and user consent management." },
            { name: "SAPISID", domain: ".google.com", purpose: "Google authentication and security", required: "Yes", reason: "Essential for authentication and security." },
            { name: "SAPISID", domain: ".google.co.za", purpose: "Google authentication and security", required: "Yes", reason: "Essential for authentication and security." },
            { name: "SEARCH_SAMESITE", domain: ".google.com", purpose: "Google Search SameSite cookie for security", required: "Yes", reason: "Essential for security and cross-site request protection." },
            { name: "SID", domain: ".google.co.za", purpose: "Google session authentication", required: "Yes", reason: "Essential for session management." },
            { name: "SID", domain: ".google.com", purpose: "Google session authentication", required: "Yes", reason: "Essential for session management." },
            { name: "SIDCC", domain: ".google.com", purpose: "Google session authentication with cross-domain context", required: "Yes", reason: "Essential for cross-domain session management." },
            { name: "SSID", domain: ".google.co.za", purpose: "Google session authentication", required: "Yes", reason: "Essential for session management." },
            { name: "SSID", domain: ".google.com", purpose: "Google session authentication", required: "Yes", reason: "Essential for session management." },
            { name: "UserMatchHistory", domain: ".linkedin.com", purpose: "LinkedIn ad targeting and user matching history", required: "No", reason: "Used for ad targeting; not essential for core functionality." }
        ];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', options);
            
            // Initialize calendar
            generateCalendar(new Date());
            
            // Compare button functionality
            document.getElementById('compare-btn').addEventListener('click', compareCookies);
            
            // Save/load functionality
            setupSaveLoad();
            
            // Export to PowerPoint functionality
            document.getElementById('export-btn').addEventListener('click', exportToPowerPoint);
            
            // Initialize interactive bubble
            const interBubble = document.querySelector('.interactive');
            let curX = 0;
            let curY = 0;
            let tgX = 0;
            let tgY = 0;

            function move() {
                curX += (tgX - curX) / 20;
                curY += (tgY - curY) / 20;
                interBubble.style.transform = `translate(${Math.round(curX)}px, ${Math.round(curY)}px)`;
                requestAnimationFrame(() => {
                    move();
                });
            }

            window.addEventListener('mousemove', (event) => {
                tgX = event.clientX;
                tgY = event.clientY;
            });

            move();
            
            // Automatically populate the "Before Accepting Cookies" textarea with all cookies
            const beforeTextarea = document.getElementById('before-cookies');
            let allCookiesText = '';
            cookieDatabase.forEach(cookie => {
                allCookiesText += `${cookie.name}\t${cookie.domain}\n`;
            });
            beforeTextarea.value = allCookiesText.trim();
            
            // Automatically populate the cookie details table with all cookies
            populateCookieDetailsTable(cookieDatabase);
        });

        function compareCookies() {
            const beforeText = document.getElementById('before-cookies').value;
            const afterText = document.getElementById('after-cookies').value;
            
            const beforeCookies = beforeText.split('\n').filter(line => line.trim() !== '');
            const afterCookies = afterText.split('\n').filter(line => line.trim() !== '');
            
            // Find dropped cookies (in before but not after)
            const droppedCookies = beforeCookies.filter(cookie => !afterCookies.includes(cookie));
            
            // Find added cookies (in after but not before)
            const addedCookies = afterCookies.filter(cookie => !beforeCookies.includes(cookie));
            
            // Display results
            const droppedList = document.getElementById('dropped-list');
            droppedList.innerHTML = '';
            droppedCookies.forEach(cookie => {
                const item = document.createElement('div');
                item.className = 'result-item dropped-item';
                item.textContent = cookie;
                droppedList.appendChild(item);
            });
            
            const addedList = document.getElementById('added-list');
            addedList.innerHTML = '';
            addedCookies.forEach(cookie => {
                const item = document.createElement('div');
                item.className = 'result-item added-item';
                item.textContent = cookie;
                addedList.appendChild(item);
            });

            // Populate cookie details table with all cookies
            populateCookieDetailsTable(cookieDatabase);
        }

        function populateCookieDetailsTable(cookies) {
            const tbody = document.getElementById('cookie-details-body');
            tbody.innerHTML = '';
            
            if (cookies.length === 0) {
                // Add placeholder rows if no cookies
                for (let i = 0; i < 10; i++) {
                    const row = document.createElement('tr');
                    row.className = 'placeholder-row';
                    row.innerHTML = i === 0 ? 
                        '<td colspan="5">No cookies found</td>' : 
                        '<td colspan="5"></td>';
                    tbody.appendChild(row);
                }
                return;
            }
            
            // Populate the table with all cookies
            cookies.forEach(cookie => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${cookie.name}</td>
                    <td>${cookie.domain}</td>
                    <td>${cookie.purpose}</td>
                    <td>${cookie.required}</td>
                    <td>${cookie.reason}</td>
                `;
                
                tbody.appendChild(row);
            });

            // Ensure we always have at least 10 rows for consistent height
            while (tbody.children.length < 10 && tbody.children.length < cookies.length) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="5"></td>';
                tbody.appendChild(row);
            }
        }

        function generateCalendar(date) {
            const calendarContainer = document.getElementById('calendar-container');
            const year = date.getFullYear();
            const month = date.getMonth();
            
            // Get first and last days of month
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // Get days in month
            const daysInMonth = lastDay.getDate();
            
            // Get starting day of week (0-6)
            const startingDay = firstDay.getDay();
            
            // Create calendar header
            const monthNames = ["January", "February", "March", "April", "May", "June",
                              "July", "August", "September", "October", "November", "December"];
            
            const calendarHTML = `
                <div class="calendar-nav">
                    <button id="prev-month">&lt; Prev</button>
                    <div class="calendar-title">${monthNames[month]} ${year}</div>
                    <button id="next-month">Next &gt;</button>
                </div>
                <table class="calendar">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody id="calendar-body">
                        ${generateCalendarRows(year, month, daysInMonth, startingDay)}
                    </tbody>
                </table>
            `;
            
            calendarContainer.innerHTML = calendarHTML;
            
            // Add event listeners for navigation
            document.getElementById('prev-month').addEventListener('click', function() {
                generateCalendar(new Date(year, month - 1, 1));
            });
            
            document.getElementById('next-month').addEventListener('click', function() {
                generateCalendar(new Date(year, month + 1, 1));
            });
            
            // Add event listeners for day selection
            const days = document.querySelectorAll('.calendar td:not(.empty)');
            days.forEach(day => {
                day.addEventListener('click', function(e) {
                    if (e.target.classList.contains('calendar-day')) {
                        // Toggle selected class when clicking on the day number
                        this.classList.toggle('selected');
                    } else if (e.target.tagName === 'TD') {
                        // Create/update note when clicking elsewhere in the cell
                        const existingNote = this.querySelector('.calendar-note');
                        const existingPreview = this.querySelector('.calendar-note-preview');
                        
                        if (existingNote) {
                            const newText = prompt("Edit your note:", existingNote.textContent);
                            if (newText !== null) {
                                existingNote.textContent = newText;
                                if (existingPreview) {
                                    existingPreview.textContent = newText;
                                }
                            }
                        } else {
                            const newText = prompt("Add a note for this day:");
                            if (newText !== null && newText.trim() !== '') {
                                const note = document.createElement('div');
                                note.className = 'calendar-note';
                                note.textContent = newText;
                                this.appendChild(note);
                                
                                const preview = document.createElement('div');
                                preview.className = 'calendar-note-preview';
                                preview.textContent = newText;
                                this.appendChild(preview);
                            }
                        }
                    }
                });
            });
        }
        
        function generateCalendarRows(year, month, daysInMonth, startingDay) {
            let rows = '';
            let day = 1;
            const today = new Date();
            
            for (let i = 0; i < 6; i++) { // 6 rows max to cover all possibilities
                // If we've passed the last day, break
                if (day > daysInMonth) break;
                
                rows += '<tr>';
                
                for (let j = 0; j < 7; j++) { // 7 days in a week
                    if (i === 0 && j < startingDay) {
                        // Empty cells before the first day
                        rows += '<td class="empty"></td>';
                    } else if (day > daysInMonth) {
                        // Empty cells after the last day
                        rows += '<td class="empty"></td>';
                    } else {
                        // Cells with days
                        const currentDate = new Date(year, month, day);
                        const isToday = currentDate.getDate() === today.getDate() && 
                                       currentDate.getMonth() === today.getMonth() && 
                                       currentDate.getFullYear() === today.getFullYear();
                        
                        rows += `
                            <td data-date="${year}-${month + 1}-${day}">
                                <div class="calendar-day ${isToday ? 'today' : ''}">${day}</div>
                            </td>
                        `;
                        day++;
                    }
                }
                
                rows += '</tr>';
            }
            
            return rows;
        }

        function setupSaveLoad() {
            const saveBtn = document.getElementById('save-btn');
            const loadBtn = document.getElementById('load-btn');
            
            saveBtn.addEventListener('click', saveAudit);
            loadBtn.addEventListener('click', function() {
                document.getElementById('load-upload').click();
            });
            
            document.getElementById('load-upload').addEventListener('change', loadAudit);
        }

        function saveAudit() {
            // Gather all data
            const auditData = {
                title: document.querySelector('h1').textContent,
                date: document.getElementById('current-date').textContent,
                beforeCookies: document.getElementById('before-cookies').value,
                afterCookies: document.getElementById('after-cookies').value,
                droppedCookies: Array.from(document.querySelectorAll('#dropped-list .result-item')).map(item => item.textContent),
                addedCookies: Array.from(document.querySelectorAll('#added-list .result-item')).map(item => item.textContent),
                calendarNotes: {}
            };
            
            // Save calendar notes
            const calendarDays = document.querySelectorAll('.calendar td[data-date]');
            calendarDays.forEach(day => {
                const date = day.getAttribute('data-date');
                const note = day.querySelector('.calendar-note');
                if (note) {
                    auditData.calendarNotes[date] = {
                        note: note.textContent,
                        selected: day.classList.contains('selected')
                    };
                }
            });
            
            // Create download
            const dataStr = JSON.stringify(auditData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `Cookie_Audit_${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show feedback
            alert('Audit saved successfully!');
        }

        function loadAudit(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const auditData = JSON.parse(event.target.result);
                    
                    // Load basic info
                    document.querySelector('h1').textContent = auditData.title || 'BP3 Cookie Audit';
                    document.getElementById('current-date').textContent = auditData.date || new Date().toLocaleDateString('en-US', 
                        { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                    
                    // Load cookie data
                    document.getElementById('before-cookies').value = auditData.beforeCookies || '';
                    document.getElementById('after-cookies').value = auditData.afterCookies || '';
                    
                    // Load dropped cookies
                    const droppedList = document.getElementById('dropped-list');
                    droppedList.innerHTML = '';
                    if (auditData.droppedCookies && auditData.droppedCookies.length > 0) {
                        auditData.droppedCookies.forEach(cookie => {
                            const item = document.createElement('div');
                            item.className = 'result-item dropped-item';
                            item.textContent = cookie;
                            droppedList.appendChild(item);
                        });
                    }
                    
                    // Load added cookies
                    const addedList = document.getElementById('added-list');
                    addedList.innerHTML = '';
                    if (auditData.addedCookies && auditData.addedCookies.length > 0) {
                        auditData.addedCookies.forEach(cookie => {
                            const item = document.createElement('div');
                            item.className = 'result-item added-item';
                            item.textContent = cookie;
                            addedList.appendChild(item);
                        });
                    }
                    
                    // Populate cookie details table with all cookies
                    populateCookieDetailsTable(cookieDatabase);
                    
                    // Load calendar notes
                    if (auditData.calendarNotes) {
                        // First generate the calendar for the current month
                        generateCalendar(new Date());
                        
                        // After a short delay (to allow DOM to update), load the notes
                        setTimeout(() => {
                            for (const [date, data] of Object.entries(auditData.calendarNotes)) {
                                const dayCell = document.querySelector(`.calendar td[data-date="${date}"]`);
                                if (dayCell) {
                                    if (data.selected) {
                                        dayCell.classList.add('selected');
                                    }
                                    
                                    if (data.note) {
                                        const note = document.createElement('div');
                                        note.className = 'calendar-note';
                                        note.textContent = data.note;
                                        dayCell.appendChild(note);
                                        
                                        const preview = document.createElement('div');
                                        preview.className = 'calendar-note-preview';
                                        preview.textContent = data.note;
                                        dayCell.appendChild(preview);
                                    }
                                }
                            }
                        }, 100);
                    }
                    
                    // Show feedback
                    alert('Audit loaded successfully!');
                } catch (error) {
                    alert('Error loading audit: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function exportToPowerPoint() {
            // Create a simple PowerPoint export (this would need a proper library in a real implementation)
            alert("In a real implementation, this would export the audit to PowerPoint.\nFor now, we'll simulate the export with a download of the data.");
            
            // Gather all data for export
            const exportData = {
                title: document.querySelector('h1').textContent,
                date: document.getElementById('current-date').textContent,
                beforeCookies: document.getElementById('before-cookies').value,
                afterCookies: document.getElementById('after-cookies').value,
                droppedCookies: Array.from(document.querySelectorAll('#dropped-list .result-item')).map(item => item.textContent),
                addedCookies: Array.from(document.querySelectorAll('#added-list .result-item')).map(item => item.textContent),
                cookieDetails: cookieDatabase,
                calendarNotes: {}
            };
            
            // Get calendar notes
            const calendarDays = document.querySelectorAll('.calendar td[data-date]');
            calendarDays.forEach(day => {
                const date = day.getAttribute('data-date');
                const note = day.querySelector('.calendar-note');
                if (note) {
                    exportData.calendarNotes[date] = {
                        note: note.textContent,
                        selected: day.classList.contains('selected')
                    };
                }
            });
            
            // Create a simple text representation (in a real app, you'd use a PPT library)
            let pptContent = `BP3 Cookie Audit\n${exportData.date}\n\n`;
            pptContent += `Before Cookies:\n${exportData.beforeCookies}\n\n`;
            pptContent += `After Cookies:\n${exportData.afterCookies}\n\n`;
            pptContent += `Dropped Cookies:\n${exportData.droppedCookies.join('\n')}\n\n`;
            pptContent += `Added Cookies:\n${exportData.addedCookies.join('\n')}\n\n`;
            pptContent += `Cookie Details:\n`;
            exportData.cookieDetails.forEach(cookie => {
                pptContent += `${cookie.name} (${cookie.domain}): ${cookie.purpose}\n`;
            });
            
            // Create download
            const dataBlob = new Blob([pptContent], { type: 'text/plain' });
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `Cookie_Audit_${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
